{"version":3,"file":"utils.js","sourceRoot":"","sources":["../../src/utils/utils.ts"],"names":[],"mappings":"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","sourcesContent":["export const assignLanguage = (el: HTMLElement) => {\n  let lang = '';\n  if (!el.getAttribute('lang')) {\n    const closestLangAttribute = closestElement('[lang]', el)?.getAttribute('lang');\n    if (closestLangAttribute == 'en' || !closestLangAttribute) {\n      lang = 'en';\n    } else {\n      lang = 'fr';\n    }\n  } else if (el.getAttribute('lang') == 'en') {\n    lang = 'en';\n  } else {\n    lang = 'fr';\n  }\n\n  return lang;\n};\n\n// Allows use of closest() function across shadow boundaries\nexport const closestElement = (selector, el) => {\n  if (el) {\n    return (el && el != document && typeof window != 'undefined' && el != window && el.closest(selector)) || closestElement(selector, el.getRootNode().host);\n  }\n\n  return null;\n};\n\n// Removes unwanted attributes from display element\nexport const removeUnwantedAttributes = html => {\n  const regex = /\\s*(aria-[a-z-]+|class|(?<!-)\\brole\\b)=\"[^\"]*\"/g;\n  return html.replace(regex, '');\n};\n\nexport type AttributesType = {\n  name: string;\n  control: 'select' | 'text' | 'none';\n  options?: Array<string>;\n  required?: boolean;\n  defaultValue?: string;\n  type?: string;\n  onlyProperty?: boolean;\n};\n\nexport type SlotType = {\n  name: string;\n  description: string;\n};\n\nexport type EventType = {\n  name: string;\n  description: string;\n  details: string | object;\n};\n\nexport const srcDoc = `<!DOCTYPE html>\n<html lang=\"{{lang}}\">\n<head>\n  <meta charset=\"UTF-8\" />\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n  <title>Landmark Elements</title>\n  <link rel=\"stylesheet\" href=\"/components/dist/gcds.css\" />\n  <script type=\"module\" src=\"/components/dist/gcds.esm.js\"></script>\n  <link\n    rel=\"stylesheet\"\n    href=\"https://cdn.design-system.alpha.canada.ca/@gcds-core/css-shortcuts@latest/dist/gcds-css-shortcuts.min.css\"\n  />\n  {{axeScript}}\n</head>\n<body class=\"p-150\">\n  {{displayElement}}\n</body>\n</html>`;\n\nexport const formatSrcDoc = (displayElement: string, accessibility: boolean = false, lang: string = 'en') => {\n  let doc = srcDoc;\n  if (accessibility) {\n    const axeScript = `<script src=\"https://cdn.jsdelivr.net/npm/axe-core@4.7.2/axe.min.js\"></script>`;\n    doc = doc.replace('{{axeScript}}', axeScript);\n  } else {\n    doc = doc.replace('{{axeScript}}', '');\n  }\n  doc = doc.replace('{{lang}}', lang);\n  doc = doc.replace('{{displayElement}}', displayElement);\n\n  return doc;\n};\n\nexport const formatDataLabel = (label: string, lang: string) => {\n  return lang === 'fr' ? `${label} : ` : `${label}:`;\n};\n\n/* ---------------------------\n * Iframe Helpers\n * --------------------------- */\n\nexport const iframeListeners = (iframe: HTMLIFrameElement) => {\n  const resize = new ResizeObserver(() => {\n    setIframeHeight(iframe);\n  });\n\n  resize.observe(iframe.contentDocument.body);\n\n  // Build extra logic to handle opening of nav-groups desktop and mobile versions\n  const handleMutations = mutationsList => {\n    for (const mutation of mutationsList) {\n      if (mutation.target.nodeName == 'GCDS-NAV-GROUP') {\n        if (mutation.target.classList.contains('gcds-mobile-nav')) {\n          const additionalHeight = mutation.target.shadowRoot.querySelector('ul.gcds-nav-group__list')?.getBoundingClientRect().height || 0;\n          // Additional logic to keep body from shrinking\n          iframe.contentDocument.body.style.height = `${additionalHeight / 16 + 7.25}rem`;\n          setIframeHeight(iframe, additionalHeight / 16 + 3);\n        } else if (mutation.target.closest('gcds-top-nav') && iframe.contentWindow.innerWidth <= 1024) {\n          const additionalHeight =\n            mutation.target\n              .closest('gcds-top-nav')\n              .shadowRoot.querySelector('gcds-nav-group.gcds-mobile-nav')\n              .shadowRoot.querySelector('ul.gcds-nav-group__list')\n              ?.getBoundingClientRect().height || 0;\n          iframe.contentDocument.body.style.height = `${additionalHeight / 16 + 7.25}rem`;\n          setIframeHeight(iframe, additionalHeight / 16);\n        } else {\n          const additionalHeight = mutation.target.shadowRoot.querySelector('ul.gcds-nav-group__list')?.getBoundingClientRect().height || 0;\n          iframe.contentDocument.body.style.height = 'auto';\n          setIframeHeight(iframe, additionalHeight / 16);\n        }\n      }\n    }\n  };\n\n  const observer = new MutationObserver(handleMutations);\n\n  // Check for gcds-nav-group inside gcds-top-nav\n  const navGroup = iframe.contentDocument.querySelector('gcds-top-nav > gcds-nav-group');\n\n  if (navGroup) {\n    observer.observe(navGroup, {\n      attributes: true,\n      attributeFilter: ['open'],\n    });\n  }\n\n  // Mobile top-nav and side-nav\n\n  const nav = iframe.contentDocument.querySelector('gcds-top-nav') || iframe.contentDocument.querySelector('gcds-side-nav');\n\n  if (nav) {\n    observer.observe(nav.shadowRoot.querySelector('gcds-nav-group.gcds-mobile-nav'), {\n      attributes: true,\n      attributeFilter: ['open'],\n    });\n  }\n};\n\nconst setIframeHeight = (iframe: HTMLIFrameElement, additional: number = 0) => {\n  iframe.style.setProperty('--component-display-iframe-height', `${iframe.contentDocument.body.getBoundingClientRect().height / 16 + additional + 3}rem`);\n};\n"]}