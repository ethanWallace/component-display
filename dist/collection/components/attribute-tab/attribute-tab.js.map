{"version":3,"file":"attribute-tab.js","sourceRoot":"","sources":["../../../src/components/attribute-tab/attribute-tab.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, Host, h, Element, Prop, Event, EventEmitter, State } from '@stencil/core';\n\nimport { AttributesType, assignLanguage, closestElement, formatDataLabel } from '../../utils/utils';\nimport i18n from './i18n/i18n';\n\n@Component({\n  tag: 'attribute-tab',\n  styleUrl: 'attribute-tab.css',\n  shadow: false,\n})\nexport class AttributeTab {\n  @Element() el: HTMLElement;\n\n  private valueChecker: number | null = null;\n  private lastInputValue = {};\n\n  /* ---------------------------\n   * Props\n   * --------------------------- */\n\n  @Prop() attributeObject: Array<AttributesType>;\n  @Prop() displayElement!: Element;\n\n  /* ---------------------------\n   * Events\n   * --------------------------- */\n\n  @Event() attributeChange!: EventEmitter<Object>;\n  @Event() statusUpdate!: EventEmitter<Object>;\n\n  /* ---------------------------\n   * State\n   * --------------------------- */\n\n  @State() lang: string = 'en';\n  @State() lastInputTimestamp = [];\n\n  /* ---------------------------\n   * Helpers\n   * --------------------------- */\n\n  private formatEventDetail(e) {\n    const eventDetail = {\n      name: e.target.name,\n      value: e.target.value,\n    };\n\n    // Store timestamp and value of element for comparison in interval\n    this.lastInputTimestamp[e.target.name] = Date.now();\n    this.lastInputValue[e.target.name] = e.target.value;\n\n    this.attributeChange.emit(eventDetail);\n  }\n\n  private onFocusStartInterval = (e) => {\n    const element = e.target.shadowRoot.querySelector(`[name=\"${e.target.name}\"]`);\n    const value = element.value;\n    const name = element.name;\n    // Start value checking on input\n    this.valueChecker = window.setInterval(() => {\n      if (\n\n        Date.now() - 500 >= this.lastInputTimestamp[name]\n      ) {\n        if (value !== this.lastInputValue[name]) {\n          this.statusUpdate.emit({ name: name, type: 'attribute' });\n          clearInterval(this.valueChecker);\n        }\n      }\n    }, 1000);\n\n  }\n\n  private onBlurClearInterval = () => {\n    if (this.valueChecker) {\n      window.clearInterval(this.valueChecker);\n    }\n  }\n\n  /* ---------------------------\n   * Lifecycle\n   * --------------------------- */\n\n  async componentWillLoad() {\n    // Define lang attribute\n    this.lang = assignLanguage(this.el);\n  }\n\n  /* ---------------------------\n   * Render\n   * --------------------------- */\n\n  render() {\n    const { lang } = this;\n\n    return (\n      <Host role=\"tabpanel\" tabindex=\"0\">\n        <table class=\"attributes\">\n          <tr>\n            <th>{i18n[lang].attributes}</th>\n            <th>{i18n[lang].type}</th>\n            <th>{i18n[lang].defaultValue}</th>\n            <th>{i18n[lang].control}</th>\n          </tr>\n          {this.attributeObject &&\n            this.attributeObject.map(attr => {\n              let control = '';\n\n              let displayValue = this.displayElement.getAttribute(attr.name) != null ? this.displayElement.getAttribute(attr.name) : attr?.defaultValue;\n\n              // Special case for lang attribute to inherit from closest parent with lang attribute\n              if (attr.name === 'lang') {\n                displayValue = closestElement('[lang]', this.displayElement).getAttribute('lang') || displayValue;\n              }\n\n              this.lastInputValue = { ...this.lastInputValue, [attr.name]: displayValue };\n\n              if (attr.control === 'select') {\n                const options = typeof attr.options === 'string' ? JSON.parse(attr.options) : attr.options;\n\n                control = (\n                  <gcds-select\n                    label={attr.name}\n                    selectId={attr.name}\n                    name={attr.name}\n                    value={displayValue}\n                    hide-label\n                    onInput={e => this.formatEventDetail(e)}\n                    onFocus={e => this.onFocusStartInterval(e)}\n                    onBlur={this.onBlurClearInterval}\n                  >\n                    {typeof options === 'object' &&\n                      options.map(option => (\n                        <option key={option} value={option}>\n                          {option}\n                        </option>\n                      ))}\n                  </gcds-select>\n                );\n              } else if (attr.control === 'text') {\n                control = (\n                  <gcds-input\n                    name={attr.name}\n                    label={attr.name}\n                    inputId={attr.name}\n                    hide-label\n                    type=\"text\"\n                    value={displayValue}\n                    onInput={e => this.formatEventDetail(e)}\n                    onFocus={e => this.onFocusStartInterval(e)}\n                    onBlur={this.onBlurClearInterval}\n                  ></gcds-input>\n                );\n              }\n\n              return (\n                <tr>\n                  <td data-label={formatDataLabel(i18n[lang].attributes, lang)}>\n                    <span lang=\"en\">{attr.name}</span>\n                    {attr.required && (\n                      <span\n                        class=\"required\"\n                        aria-hidden=\"true\"\n                      >\n                        {i18n[lang].required}\n                      </span>\n                    )}</td>\n                  <td data-label={formatDataLabel(i18n[lang].type, lang)}>{attr?.type ? <span lang=\"en\">{attr.type}</span> : <gcds-sr-only tag=\"span\">{i18n[lang].noType}</gcds-sr-only>}</td>\n                  <td data-label={formatDataLabel(i18n[lang].defaultValue, lang)}>{attr?.defaultValue ? <span lang=\"en\">{attr.defaultValue}</span> : <gcds-sr-only>{i18n[lang].noDefaultValue}</gcds-sr-only>}</td>\n                  <td>{control}</td>\n                </tr>\n              );\n            })}\n        </table>\n      </Host>\n    );\n  }\n}\n"]}